<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>eMenu Taipei</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            overscroll-behavior-y: none; /* é˜²æ­¢ iOS æ©¡çš®ç­‹æ•ˆæœ */
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* æ¯›ç»ç’ƒæ•ˆæœ */
        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .glass-dark {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.05);
        }
        /* å¡ç‰‡æ¼¸å…¥å‹•ç•« */
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s ease;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2A9D8F', /* å°åŒ—ç¶ /é’è‰²èª¿ */
                        secondary: '#F4A261',
                    },
                    boxShadow: {
                        'soft': '0 8px 30px rgba(0, 0, 0, 0.08)',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 h-screen w-full overflow-hidden text-gray-700">

    <div id="app" class="h-full flex flex-col relative">

        <div class="absolute inset-0 z-0 pointer-events-none">
            <img src="https://images.unsplash.com/photo-1599234346860-2e408544a86f?q=80&w=1000&auto=format&fit=crop" class="w-full h-full object-cover opacity-100" alt="Taipei Background">
            <div class="absolute inset-0 bg-gradient-to-b from-slate-100/90 via-slate-100/60 to-slate-200/90"></div>
        </div>

        <main class="flex-1 overflow-y-auto no-scrollbar z-10 pb-28 pt-14 px-5">
            
            <div class="flex justify-between items-end mb-4">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800 tracking-tight">eMenu Taipei <span class="text-xl">ğŸ‡¹ğŸ‡¼</span></h1>
                    <p class="text-xs text-gray-500 font-medium mt-1">2025.12.15 - 12.18</p>
                </div>
                <div class="text-right">
                     <span class="text-[10px] font-bold text-emerald-700 bg-emerald-100 px-2 py-1 rounded-md border border-emerald-200">
                        å³æ™‚åŒ¯ç‡
                    </span>
                    <div class="text-xs font-bold text-gray-600 mt-1">
                        1 TWD â‰ˆ <span class="text-emerald-600 text-sm">{{ exchangeRate }}</span> HKD
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'itinerary'" class="animate-fade">
                
                <div class="flex overflow-x-auto no-scrollbar gap-3 mb-6 py-2 px-1">
                    <div v-for="(day, index) in days" :key="index" 
                         @click="selectedDayIndex = index"
                         class="flex-shrink-0 w-16 h-20 rounded-2xl flex flex-col items-center justify-center transition-all duration-300 shadow-sm border"
                         :class="selectedDayIndex === index ? 'bg-gray-800 text-white border-gray-800 shadow-lg scale-105' : 'bg-white/80 text-gray-400 border-white glass'">
                        <span class="text-[10px] font-bold uppercase tracking-wider mb-1">{{ day.weekDay }}</span>
                        <span class="text-xl font-bold">{{ day.date }}</span>
                    </div>
                </div>

                <div class="glass p-5 rounded-3xl shadow-soft mb-6 flex items-center justify-between relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="flex items-baseline gap-2">
                            <span class="text-4xl font-bold text-gray-800">{{ weather.temp }}Â°</span>
                            <span class="text-lg text-gray-500">C</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1 font-medium">{{ weather.desc }} Â· é™é›¨æ©Ÿç‡ {{ weather.rain }}%</p>
                    </div>
                    <div class="bg-orange-100 p-3 rounded-full text-orange-500 relative z-10">
                        <i :class="weather.icon + ' text-3xl'"></i>
                    </div>
                    <div class="bg-white/60 px-3 py-1 rounded-full text-xs font-bold text-gray-600 absolute top-4 right-4 backdrop-blur-sm">
                        å°åŒ—å¸‚
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="flex justify-between items-center mb-1 px-1">
                        <h2 class="font-bold text-gray-700 text-lg">æœ¬æ—¥å®‰æ’</h2>
                        <span class="text-xs text-gray-400 bg-white px-2 py-1 rounded-lg shadow-sm">
                            {{ currentItinerary.subtitle }}
                        </span>
                    </div>

                    <div v-if="currentItinerary.flight" class="bg-gray-800 text-white p-5 rounded-3xl shadow-xl relative overflow-hidden mb-4">
                        <div class="relative z-10">
                            <div class="flex justify-between items-center mb-6">
                                <span class="bg-white/20 px-2 py-0.5 rounded text-[10px] font-bold tracking-wider">CATHAY PACIFIC</span>
                                <span class="font-mono text-lg text-emerald-300">{{ currentItinerary.flight.time }}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="text-xs opacity-60 mb-1">DEP</div>
                                    <div class="text-3xl font-bold tracking-widest">{{ currentItinerary.flight.from }}</div>
                                </div>
                                <div class="flex-1 flex flex-col items-center px-4">
                                    <i class="ph ph-airplane-tilt text-2xl mb-1 text-emerald-400"></i>
                                    <div class="w-full h-0.5 bg-white/20 border-t border-dashed border-white/40"></div>
                                    <span class="text-[10px] mt-1 opacity-60">{{ currentItinerary.flight.duration }}</span>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs opacity-60 mb-1">ARR</div>
                                    <div class="text-3xl font-bold tracking-widest">{{ currentItinerary.flight.to }}</div>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-between items-end border-t border-white/10 pt-3">
                                <div class="flex flex-col">
                                    <span class="text-[10px] opacity-60">FLIGHT NO.</span>
                                    <span class="text-lg font-bold text-emerald-300">{{ currentItinerary.flight.code }}</span>
                                </div>
                                <span class="bg-emerald-500 text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-lg shadow-emerald-900/50">å·²ç¢ºèª</span>
                            </div>
                        </div>
                    </div>

                    <div v-for="(item, idx) in currentItinerary.events" :key="idx" 
                         class="glass p-4 rounded-2xl shadow-sm flex gap-4 items-center group active:scale-95 transition-transform">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0"
                             :class="item.type === 'food' ? 'bg-orange-100 text-orange-500' : (item.type === 'shop' ? 'bg-blue-100 text-blue-500' : 'bg-gray-200 text-gray-500')">
                            <i :class="getIcon(item.type) + ' text-xl'"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-gray-800 text-sm">{{ item.title }}</h3>
                            <p class="text-xs text-gray-500 mt-0.5" v-if="item.note">{{ item.note }}</p>
                        </div>
                        <div class="text-right flex flex-col items-end">
                            <span class="text-xs font-bold text-gray-400 bg-gray-50 px-1.5 py-0.5 rounded">{{ item.time || 'è¡Œç¨‹' }}</span>
                            <button class="mt-2 text-gray-300"><i class="ph ph-caret-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'map'" class="h-full w-full rounded-3xl overflow-hidden shadow-soft glass animate-fade relative">
                 <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3614.703632537248!2d121.50379517605177!3d25.04412927780968!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442a90a8d4d6239%3A0x6239562886c963b6!2z6KW_6ZaA55S6!5e0!3m2!1szh-TW!2stw!4v1709620000000!5m2!1szh-TW!2stw" 
                        width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                
                <div class="absolute bottom-4 left-4 right-4 bg-white p-4 rounded-2xl shadow-xl">
                    <h3 class="font-bold text-gray-800">è¥¿é–€ç”ºæ°¸å®‰æ£§</h3>
                    <p class="text-xs text-gray-500 mt-1">å°åŒ—å¸‚è¬è¯å€ä¸­è¯è·¯ä¸€æ®µ150è™Ÿ</p>
                    <div class="flex gap-2 mt-3">
                         <button class="flex-1 bg-blue-500 text-white text-xs font-bold py-2 rounded-lg shadow-md flex items-center justify-center gap-1">
                            <i class="ph ph-navigation-arrow-fill"></i> å°èˆª
                         </button>
                         <button class="flex-1 bg-gray-100 text-gray-700 text-xs font-bold py-2 rounded-lg flex items-center justify-center gap-1">
                            <i class="ph ph-copy"></i> è¤‡è£½åœ°å€
                         </button>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'budget'" class="animate-fade">
                <div class="glass p-6 rounded-3xl shadow-soft text-center mb-6 relative overflow-hidden bg-gradient-to-br from-gray-800 to-gray-900 text-white">
                    <p class="text-sm opacity-60 mb-1">ç›®å‰ç¸½æ”¯å‡º (HKD)</p>
                    <h2 class="text-4xl font-bold mb-2 tracking-tight">$ {{ totalExpense }}</h2>
                    <p class="text-xs opacity-50 font-mono">å°å¹£ç´„ TWD {{ (totalExpense / exchangeRate).toFixed(0) }}</p>

                    <div class="grid grid-cols-2 gap-4 mt-6 pt-4 border-t border-white/10">
                        <div>
                            <div class="text-[10px] uppercase tracking-wider opacity-60 mb-1">Cash</div>
                            <div class="font-bold text-lg">$ {{ expenses.filter(e => e.type === 'cash').reduce((a, b) => a + b.amount, 0) }}</div>
                        </div>
                        <div class="border-l border-white/10">
                            <div class="text-[10px] uppercase tracking-wider opacity-60 mb-1">Credit Card</div>
                            <div class="font-bold text-lg">$ {{ expenses.filter(e => e.type === 'card').reduce((a, b) => a + b.amount, 0) }}</div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between items-center mb-3 px-2">
                    <h3 class="font-bold text-gray-700">æ”¯å‡ºæ˜ç´°</h3>
                    <button @click="addExpense" class="text-xs font-bold text-emerald-600 bg-emerald-50 px-3 py-1.5 rounded-lg border border-emerald-100">
                        + è¨˜ä¸€ç­†
                    </button>
                </div>

                <div class="space-y-3 pb-10">
                     <div v-for="item in expenses" :key="item.id" class="glass p-4 rounded-2xl flex items-center justify-between border-l-4" :class="item.type === 'cash' ? 'border-l-orange-400' : 'border-l-blue-400'">
                        <div class="flex items-center gap-3">
                            <div class="w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-500">
                                <i :class="item.icon"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-sm text-gray-800">{{ item.name }}</h4>
                                <span class="text-[10px] text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded">{{ item.date }}</span>
                            </div>
                        </div>
                        <div class="text-right">
                             <span class="font-bold text-gray-800 block">- ${{ item.amount }}</span>
                             <span class="text-[10px] text-gray-400" v-if="item.twd">NT$ {{ item.twd }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'shopping'" class="animate-fade">
                <div class="flex justify-between items-center mb-4">
                    <span class="bg-gray-800 text-white px-3 py-1 rounded-lg text-sm font-bold shadow-lg shadow-gray-300">å¿…è²·æ¸…å–®</span>
                    <button @click="addShoppingItem" class="w-8 h-8 rounded-full bg-emerald-500 text-white flex items-center justify-center shadow-lg shadow-emerald-200 hover:scale-110 transition">
                        <i class="ph ph-plus text-lg"></i>
                    </button>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div v-for="item in shoppingList" :key="item.id" class="bg-white p-3 rounded-2xl shadow-sm pb-10 relative transition-all duration-300" :class="item.checked ? 'opacity-60 grayscale' : ''">
                        <div class="aspect-square bg-gray-100 rounded-xl mb-3 overflow-hidden relative">
                             <img :src="item.image" class="w-full h-full object-cover">
                             <div v-if="item.checked" class="absolute inset-0 bg-black/10 flex items-center justify-center">
                                 <i class="ph ph-check-circle text-4xl text-white drop-shadow-md"></i>
                             </div>
                        </div>
                        <h3 class="text-xs font-bold text-gray-800 mb-1 leading-tight h-8 overflow-hidden">{{ item.name }}</h3>
                        <p class="text-xs text-orange-500 font-bold">NT$ {{ item.price }}</p>
                        
                        <div class="absolute bottom-3 right-3">
                             <button @click="toggleChecked(item)" 
                                     class="w-8 h-8 rounded-full flex items-center justify-center transition-all shadow-sm"
                                     :class="item.checked ? 'bg-emerald-500 text-white scale-90' : 'bg-gray-100 text-gray-400 hover:bg-gray-200'">
                                <i class="ph text-sm" :class="item.checked ? 'ph-check-bold' : 'ph-check'"></i>
                             </button>
                        </div>
                    </div>
                </div>
            </div>

             <div v-if="currentTab === 'info'" class="animate-fade">
                <h2 class="font-bold text-xl text-gray-800 mb-4">å¯¦ç”¨è³‡è¨Š</h2>
                
                <div class="space-y-3">
                    <div class="glass p-4 rounded-2xl flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-2xl">
                            <i class="ph ph-phone"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800">ç·Šæ€¥è¯çµ¡</h3>
                            <p class="text-xs text-gray-500">æ—…å¤–åœ‹äººæ€¥é›£æ•‘åŠ©</p>
                            <a href="tel:119" class="text-xs text-blue-500 underline mt-1 block">æ’¥æ‰“ 119 (æ•‘è­·/æ¶ˆé˜²)</a>
                        </div>
                    </div>

                    <div class="glass p-4 rounded-2xl flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-2xl">
                            <i class="ph ph-taxi"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800">äº¤é€šè³‡è¨Š</h3>
                            <p class="text-xs text-gray-500">Uber / 55688 å°ç£å¤§è»ŠéšŠ</p>
                        </div>
                    </div>

                    <div class="glass p-4 rounded-2xl">
                         <h3 class="font-bold text-gray-800 mb-2">ä½å®¿è³‡è¨Š</h3>
                         <div class="bg-gray-50 p-3 rounded-xl border border-gray-100">
                             <p class="text-sm font-bold">è¥¿é–€ç”ºæ°¸å®‰æ£§ (Westgate Hotel)</p>
                             <p class="text-xs text-gray-500 mt-1">Check-in: 15:00 | Check-out: 11:00</p>
                             <p class="text-xs text-gray-500 mt-1">é›»è©±: +886 2 2352 3090</p>
                         </div>
                    </div>
                </div>
            </div>
            
            <div class="h-10"></div>
        </main>

        <nav class="absolute bottom-0 w-full glass-dark pb-safe pt-2 px-2 rounded-t-3xl shadow-[0_-5px_30px_rgba(0,0,0,0.05)] z-20">
            <div class="grid grid-cols-5 h-20 pb-4">
                
                <button @click="currentTab = 'itinerary'" class="flex flex-col items-center justify-center gap-1 transition-all" :class="currentTab === 'itinerary' ? 'text-gray-800 -translate-y-1' : 'text-gray-400'">
                    <div class="rounded-2xl px-4 py-1 transition-colors" :class="currentTab === 'itinerary' ? 'bg-gray-100' : ''">
                        <i class="ph text-2xl" :class="currentTab === 'itinerary' ? 'ph-calendar-check-fill' : 'ph-calendar-check'"></i>
                    </div>
                    <span class="text-[10px] font-medium">è¡Œç¨‹</span>
                </button>

                <button @click="currentTab = 'map'" class="flex flex-col items-center justify-center gap-1 transition-all" :class="currentTab === 'map' ? 'text-gray-800 -translate-y-1' : 'text-gray-400'">
                     <div class="rounded-2xl px-4 py-1 transition-colors" :class="currentTab === 'map' ? 'bg-gray-100' : ''">
                        <i class="ph text-2xl" :class="currentTab === 'map' ? 'ph-map-trifold-fill' : 'ph-map-trifold'"></i>
                     </div>
                    <span class="text-[10px] font-medium">åœ°åœ–</span>
                </button>

                <button @click="currentTab = 'budget'" class="flex flex-col items-center justify-center gap-1 transition-all" :class="currentTab === 'budget' ? 'text-gray-800 -translate-y-1' : 'text-gray-400'">
                     <div class="rounded-2xl px-4 py-1 transition-colors" :class="currentTab === 'budget' ? 'bg-gray-100' : ''">
                        <i class="ph text-2xl" :class="currentTab === 'budget' ? 'ph-wallet-fill' : 'ph-wallet'"></i>
                     </div>
                    <span class="text-[10px] font-medium">è¨˜å¸³</span>
                </button>

                <button @click="currentTab = 'shopping'" class="flex flex-col items-center justify-center gap-1 transition-all" :class="currentTab === 'shopping' ? 'text-gray-800 -translate-y-1' : 'text-gray-400'">
                     <div class="rounded-2xl px-4 py-1 transition-colors" :class="currentTab === 'shopping' ? 'bg-gray-100' : ''">
                        <i class="ph text-2xl" :class="currentTab === 'shopping' ? 'ph-bag-fill' : 'ph-bag'"></i>
                     </div>
                    <span class="text-[10px] font-medium">è³¼ç‰©</span>
                </button>
                
                <button @click="currentTab = 'info'" class="flex flex-col items-center justify-center gap-1 transition-all" :class="currentTab === 'info' ? 'text-gray-800 -translate-y-1' : 'text-gray-400'">
                     <div class="rounded-2xl px-4 py-1 transition-colors" :class="currentTab === 'info' ? 'bg-gray-100' : ''">
                        <i class="ph text-2xl" :class="currentTab === 'info' ? 'ph-info-fill' : 'ph-info'"></i>
                     </div>
                    <span class="text-[10px] font-medium">è³‡è¨Š</span>
                </button>
            </div>
        </nav>

    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                const currentTab = ref('itinerary');
                const selectedDayIndex = ref(0);
                const exchangeRate = ref('0.24'); // é è¨­å€¼ï¼Œä¹‹å¾Œæœƒè¢« API è¦†è“‹
                const weather = ref({ temp: '--', icon: 'ph-cloud', desc: 'è¼‰å…¥ä¸­...', rain: '0' });

                // æ—¥æœŸè¨­å®šï¼š12/15 (é€±ä¸€) - 12/18 (é€±å››)
                const days = ref([
                    { date: '15', weekDay: 'Mon', full: '2025-12-15' },
                    { date: '16', weekDay: 'Tue', full: '2025-12-16' },
                    { date: '17', weekDay: 'Wed', full: '2025-12-17' },
                    { date: '18', weekDay: 'Thu', full: '2025-12-18' },
                ]);

                // è¡Œç¨‹è³‡æ–™ (æ ¹æ“šä½ çš„éœ€æ±‚å¡«å¯«)
                const itineraryData = [
                    {
                        // Day 1: 12/15
                        subtitle: 'æŠµé”å°åŒ— Â· è¥¿é–€ç”º',
                        flight: {
                            code: 'CX400',
                            time: '13:00',
                            from: 'HKG',
                            to: 'TPE',
                            duration: '01h 50m'
                        },
                        events: [
                            { time: '14:50', title: 'æŠµé”å°åŒ—æ¡ƒåœ’æ©Ÿå ´', type: 'transport' },
                            { time: '16:30', title: 'å…¥ä½ï¼šè¥¿é–€ç”ºæ°¸å®‰æ£§', note: 'ä¼‘æ¯æ•´ç†', type: 'rest' },
                            { time: '18:00', title: 'è¥¿é–€ç”ºæ•£æ­¥', type: 'walk' },
                            { time: '19:00', title: 'æ™šé¤ï¼šé›…é¦™çŸ³é ­ç«é‹', note: 'å¿…åƒæ’éšŠåº—', type: 'food' },
                            { time: '21:00', title: 'å—æ©Ÿå ´å¤œå¸‚', note: 'å®µå¤œæ™‚é–“', type: 'food' },
                            { time: '23:00', title: 'è¿”é…’åº—ä¼‘æ¯', type: 'rest' }
                        ]
                    },
                    {
                        // Day 2: 12/16
                        subtitle: 'ç¾é£Ÿèˆ‡ Costco æ—¥',
                        flight: null,
                        events: [
                            { time: '12:00', title: 'åˆé¤ï¼šåƒæš‰éµè‚‰åº—', type: 'food' },
                            { time: '14:00', title: 'Costco ä¸­å’Œåº—', note: 'çºŒæœƒï¼‹è²·æ‰‹ä¿¡', type: 'shop' },
                            { time: '17:30', title: 'æ™šé¤ï¼šé›æ¹¯æ¦®éºµé£Ÿé¤¨', note: '17:00 å¾Œç‡Ÿæ¥­', type: 'food' },
                            { time: '19:30', title: 'è¯è¥¿è¡—å¤œå¸‚', type: 'walk' },
                            { time: '22:00', title: 'èƒ–è€é—†èª æ„è‚‰ç²¥', note: 'å®µå¤œ', type: 'food' },
                            { time: '23:30', title: 'å›é…’åº—', type: 'rest' }
                        ]
                    },
                    {
                        // Day 3: 12/17
                        subtitle: 'å°ç± åŒ…èˆ‡å¯§å¤å¤œå¸‚',
                        flight: null,
                        events: [
                            { time: '12:00', title: 'åˆé¤ï¼šæ¢å±±æ³Šå°ç± æ¹¯åŒ…', type: 'food' },
                            { time: '14:00', title: 'è¥¿é–€ç”ºé€›è¡— / Cafe', note: 'æ‚ é–’åˆå¾Œ', type: 'walk' },
                            { time: '18:30', title: 'å¯§å¤å¤œå¸‚', note: 'æ™šé¤è‡ªç†', type: 'food' },
                            { time: '21:00', title: 'å›é…’åº—ä¼‘æ¯', type: 'rest' }
                        ]
                    },
                    {
                        // Day 4: 12/18
                        subtitle: 'å›ç¨‹å‰è¼•é¬†è¡Œ',
                        flight: {
                            code: 'CX443',
                            time: '18:00', // åˆ°é”æ™‚é–“
                            from: 'TPE',
                            to: 'HKG',
                            duration: '02h 10m' // 15:50 èµ·é£›
                        },
                        events: [
                            { time: '11:00', title: 'é€€æˆ¿ / å¯„å­˜è¡Œæ', type: 'rest' },
                            { time: '12:00', title: 'è¥¿é–€ç”ºè£œè²·æ‰‹ä¿¡', type: 'shop' },
                            { time: '13:00', title: 'åˆé¤ï¼šé‡‘åœ’æ’éª¨', type: 'food' },
                            { time: '13:45', title: 'æ­è»Šå‰å¾€æ©Ÿå ´', note: 'é è¨ˆ 45 åˆ†é˜è»Šç¨‹', type: 'transport' },
                            { time: '15:50', title: 'CX443 èµ·é£›', note: 'å›ç”œèœœçš„å®¶', type: 'transport' }
                        ]
                    }
                ];

                const currentItinerary = computed(() => {
                    return itineraryData[selectedDayIndex.value];
                });

                // è³¼ç‰©æ¸…å–® (ç¯„ä¾‹)
                const shoppingList = ref([
                    { id: 1, name: 'å¾®ç†±å±±ä¸˜é³³æ¢¨é…¥', price: 420, image: 'https://shop.sunnyhills.com.tw/images/product/20230628103554_s.jpg', checked: false },
                    { id: 2, name: 'ä½³å¾·è”¥è»‹é¤…', price: 280, image: 'https://www.chiate88.com/images/product/20201026110940.jpg', checked: true },
                    { id: 3, name: 'Costco å …æœ', price: 599, image: 'https://mobilecontent.costco.com/live/resource/img/static-us-landing-page/20w08140-grocery-cat-tile-snacks.jpg', checked: false }
                ]);

                // è¨˜å¸³æ•¸æ“š (ç¯„ä¾‹)
                const expenses = ref([
                    { id: 1, name: 'é›…é¦™ç«é‹', amount: 300, twd: 1200, icon: 'ph-bowl-food', date: '12/15', type: 'cash' },
                    { id: 2, name: 'Uber æ©Ÿå ´->é…’åº—', amount: 250, twd: 1000, icon: 'ph-taxi', date: '12/15', type: 'card' }
                ]);

                const totalExpense = computed(() => {
                    return expenses.value.reduce((sum, item) => sum + item.amount, 0);
                });

                // Icon è¼”åŠ©å‡½å¼
                const getIcon = (type) => {
                    const map = {
                        food: 'ph-bowl-food',
                        shop: 'ph-bag',
                        transport: 'ph-taxi',
                        rest: 'ph-bed',
                        walk: 'ph-sneaker-move'
                    };
                    return map[type] || 'ph-circle';
                };

                const toggleChecked = (item) => item.checked = !item.checked;

                const addShoppingItem = () => {
                    const name = prompt("è¼¸å…¥å•†å“åç¨±");
                    if(name) shoppingList.value.push({ id: Date.now(), name, price: 0, image: 'https://via.placeholder.com/150', checked: false });
                };
                
                const addExpense = () => {
                     const name = prompt("è¼¸å…¥æ¶ˆè²»é …ç›®");
                     const amount = prompt("è¼¸å…¥æ¸¯å¹£é‡‘é¡");
                     if(name && amount) expenses.value.push({ id: Date.now(), name, amount: parseInt(amount), icon: 'ph-money', date: 'New', type: 'cash' });
                };

                // API: ç²å–å³æ™‚å¤©æ°£ (å°åŒ—)
                const fetchWeather = async () => {
                    try {
                        // Open-Meteo API (Free, No key needed)
                        // å°åŒ—åº§æ¨™: 25.0330, 121.5654
                        const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=25.0330&longitude=121.5654&current=temperature_2m,weather_code,precipitation_probability&timezone=Asia%2FTaipei');
                        const data = await res.json();
                        
                        const code = data.current.weather_code;
                        const temp = Math.round(data.current.temperature_2m);
                        const rain = data.current.precipitation_probability || 0; // æŸäº›ç‰ˆæœ¬ API å¯èƒ½éœ€è¦ hourly æ‰æœ‰é™é›¨æ©Ÿç‡ï¼Œé€™é‚Šåšç°¡å–®è™•ç†

                        // ç°¡å–®çš„å¤©æ°£ä»£ç¢¼å°ç…§
                        let icon = 'ph-sun';
                        let desc = 'æ™´æœ—';
                        
                        if (code > 2) { icon = 'ph-cloud'; desc = 'å¤šé›²'; }
                        if (code > 50) { icon = 'ph-cloud-rain'; desc = 'æœ‰é›¨'; }
                        if (code > 80) { icon = 'ph-cloud-lightning'; desc = 'é›·é›¨'; }

                        weather.value = { temp, icon, desc, rain };
                    } catch (e) {
                        console.error('Weather fetch failed', e);
                    }
                };

                // API: ç²å–åŒ¯ç‡
                const fetchRate = async () => {
                    try {
                        // ä½¿ç”¨ Frankfurt API (å…è²») TWD -> HKD
                        const res = await fetch('https://api.frankfurter.app/latest?from=TWD&to=HKD');
                        const data = await res.json();
                        exchangeRate.value = data.rates.HKD.toFixed(3);
                    } catch (e) {
                        console.log('Using default rate');
                        // å¤±æ•—æ™‚ä¿æŒé è¨­å€¼
                    }
                };

                onMounted(() => {
                    fetchWeather();
                    fetchRate();
                });

                return {
                    currentTab,
                    selectedDayIndex,
                    days,
                    shoppingList,
                    expenses,
                    totalExpense,
                    currentItinerary,
                    weather,
                    exchangeRate,
                    getIcon,
                    toggleChecked,
                    addShoppingItem,
                    addExpense
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
