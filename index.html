<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8" />
  <meta name="robots" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1.0,user-scalable=no" />
  <title>eMenu Taipei v3.05</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>

  <style>
    /* iOS 26 Concept Variables */
    :root {
      --glass-base: rgba(255, 255, 255, 0.65);
      --glass-border: rgba(255, 255, 255, 0.45);
      --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
      --card-radius: 24px;
      --dock-bg: rgba(245, 245, 255, 0.85);
    }
    
    html, body, #app { height: 100%; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background-color: #000;
      margin: 0;
      color: #1d1d1f;
    }

    /* Utilities */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    /* Transitions */
    .fade-enter-active, .fade-leave-active { transition: opacity .3s cubic-bezier(0.4, 0, 0.2, 1); }
    .fade-enter-from, .fade-leave-to { opacity: 0; }
    
    /* Increased padding for bottom dock */
    .pb-safe { padding-bottom: calc(env(safe-area-inset-bottom) + 90px); }
    .task-done { text-decoration: line-through; color: #86868b; opacity: 0.7; }

    /* --- iOS 26 Glass Components --- */
    
    /* Global Glass Card Style */
    .glass-card { 
        border-radius: var(--card-radius);
        background: linear-gradient(145deg, rgba(255,255,255,0.7), rgba(255,255,255,0.45));
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        border: 1px solid var(--glass-border);
        box-shadow: var(--glass-shadow);
        padding: 1rem;
    }

    /* List Items */
    .list-glass {
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), background 0.2s;
    }
    .list-glass:active {
        transform: scale(0.98);
        background: rgba(255, 255, 255, 0.65);
    }

    /* The Dock - Enlarged & Taller */
    .iphone-dock {
        background: var(--dock-bg);
        backdrop-filter: blur(30px) saturate(180%);
        -webkit-backdrop-filter: blur(30px) saturate(180%);
        border-radius: 32px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        padding: 0.8rem 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.5);
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
    }

    /* Expense Wallet Card */
    .expense-card {
      background: rgba(20, 20, 35, 0.65);
      backdrop-filter: blur(25px) saturate(120%);
      -webkit-backdrop-filter: blur(25px) saturate(120%);
      color: #ffffff;
      border-radius: 26px;
      padding: 1.5rem;
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5), inset 0 0 0 1px rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255,255,255,0.1);
      position: relative;
      overflow: hidden;
    }
    .expense-card::before {
        content: '';
        position: absolute;
        top: -50%; left: -50%; width: 200%; height: 200%;
        background: radial-gradient(circle at 50% 50%, rgba(56, 189, 248, 0.15), transparent 60%);
        pointer-events: none;
        z-index: 0;
    }

    /* Tab Button Styles */
    .tab-btn {
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        border: 1px solid transparent;
    }
    .tab-btn-active {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(16px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        border-color: rgba(255,255,255,0.6);
        transform: translateY(-2px) scale(1.02);
    }
    .tab-btn-inactive {
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(8px);
        border-color: rgba(255,255,255,0.15);
        color: #555;
    }

    @media screen and (max-width: 768px) {
        input, select, textarea { font-size: 16px !important; }
    }

    .sync-status { transition: all 0.3s ease; }
    .rotate-icon { animation: spin 1s linear infinite; }
    @keyframes spin { 100% { transform: rotate(360deg); } }
  </style>
</head>

<body>
  <div id="app" class="relative min-h-screen flex flex-col">

    <div class="absolute inset-0 z-0 pointer-events-none">
      <img src="./IMG_6732.jpeg?auto=format&fit=crop&w=2000&q=80"
           class="w-full h-full object-cover" alt="Taipei Background">
      <div class="absolute inset-0 bg-gradient-to-b from-slate-100/60 via-slate-100/40 to-slate-200/90 backdrop-blur-[2px]"></div>
    </div>

    <main class="relative z-10 flex-1 overflow-y-auto no-scrollbar pb-safe pt-8 px-5">

      <div class="flex items-center justify-between mb-6">
        <div class="flex-1 min-w-0 mr-2">
          <h1 class="text-3xl font-extrabold tracking-tight text-gray-900 drop-shadow-sm whitespace-nowrap">eMenu Taipei <span class="align-middle text-2xl">ğŸ‡¹ğŸ‡¼</span></h1>
          <div class="mt-1 pl-0.5">
            <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">å°åŒ— Â· 12/15 â€” 12/18</p>
            <div class="flex items-center gap-3 mt-1.5">
                <p class="text-[10px] font-mono text-gray-400">{{ appVersion }}</p>
                <div class="flex items-center gap-2">
                    <div class="flex items-center gap-1.5 bg-white/70 backdrop-blur-md px-2.5 py-1 rounded-full border border-white/50 shadow-sm">
                        <div class="w-2 h-2 rounded-full shadow-[0_0_5px_currentColor]" 
                            :class="{
                                'bg-emerald-500 text-emerald-500': syncState === 'synced', 
                                'bg-yellow-500 text-yellow-500 animate-pulse': syncState === 'saving', 
                                'bg-blue-500 text-blue-500 animate-pulse': syncState === 'loading',
                                'bg-red-500 text-red-500': syncState === 'error'
                            }"></div>
                        <span class="text-[10px] font-semibold sync-status whitespace-nowrap text-gray-600">
                            {{ syncStatusText }}
                        </span>
                    </div>
                    <button @click="forceReloadCloud" class="bg-white/70 backdrop-blur-md p-1.5 rounded-full border border-white/50 text-gray-600 shadow-sm active:scale-90 transition-transform" title="åŒæ­¥">
                        <i class="ph ph-arrows-clockwise text-xs" :class="{'rotate-icon': syncState === 'loading'}"></i>
                    </button>
                </div>
            </div>
          </div>
        </div>
       
        <div class="text-right flex-shrink-0">
          <div class="glass-card !p-2 !rounded-xl !bg-white/60 inline-block text-right shadow-sm border-emerald-100/50">
             <div class="text-[10px] font-bold text-emerald-600">å³æ™‚åŒ¯ç‡</div>
          </div>
          <div class="whitespace-nowrap font-medium text-gray-700 text-xs mt-1">
             1 TWD â‰ˆ <span class="text-emerald-600 font-bold text-sm">{{ formattedRate }}</span> HKD
          </div>
        </div>
      </div>

      <div class="mb-6">
        <div class="flex justify-between gap-3 overflow-x-auto no-scrollbar pb-4 px-1">
          <button @click="currentTab = 'æº–å‚™'" 
               class="tab-btn flex-shrink-0 w-[21%] h-[84px] rounded-2xl flex flex-col items-center justify-center text-xs font-semibold relative overflow-hidden"
               :class="currentTab === 'æº–å‚™' ? 'tab-btn-active text-sky-600' : 'tab-btn-inactive'">
             <div v-if="currentTab === 'æº–å‚™'" class="absolute inset-0 bg-gradient-to-br from-sky-100/50 to-transparent pointer-events-none"></div>
             <i class="ph ph-list-checks text-2xl mb-1 relative z-10"></i>
             <span class="relative z-10">æº–å‚™</span>
          </button>
          
          <button v-for="(d, i) in days" :key="i"
                  @click="selectDay(i); currentTab = 'è¡Œç¨‹'"
                  class="tab-btn flex-shrink-0 w-[22%] h-[84px] rounded-2xl flex flex-col items-center justify-center relative overflow-hidden"
                  :class="selectedDay === i && currentTab === 'è¡Œç¨‹' ? 'tab-btn-active text-sky-700' : 'tab-btn-inactive'">
            <div v-if="selectedDay === i && currentTab === 'è¡Œç¨‹'" class="absolute inset-0 bg-gradient-to-br from-teal-100/50 to-transparent pointer-events-none"></div>
            <span class="text-[10px] font-bold uppercase tracking-wide opacity-70 mb-0.5 relative z-10">Day {{ i + 1 }}</span>
            <span class="text-[11px] font-medium relative z-10">{{ d.week }}</span>
            <span class="text-xl font-bold mt-0.5 leading-none relative z-10">{{ d.date }}</span>
          </button>
        </div>
      </div>

      <div v-if="currentTab === 'è¡Œç¨‹'" class="space-y-5 mb-6">
        <div class="glass-card flex items-center justify-between relative overflow-hidden group">
          <div class="absolute right-0 top-0 w-32 h-32 bg-sky-200/30 blur-[40px] rounded-full -mr-10 -mt-10 pointer-events-none"></div>
          
          <div class="pl-2 relative z-10">
              <div class="flex items-center gap-1.5 text-gray-500 mb-1">
                <i class="ph ph-map-pin-simple-area text-xs"></i>
                <span class="text-[11px] font-bold uppercase tracking-wider">å°åŒ—å¸‚</span>
              </div>
              <div class="flex items-baseline gap-1">
                <span class="text-5xl font-light tracking-tighter text-gray-800">{{ weather.temp }}Â°</span>
              </div>
              <div class="mt-1 flex items-center gap-2">
                 <span class="px-2 py-0.5 bg-gray-100/50 rounded-full text-xs font-semibold text-gray-600 border border-white/20">{{ weather.desc }}</span>
                 <span class="text-sm font-bold text-sky-600 flex items-center bg-white/60 px-2 py-1 rounded-full">
                   é™é›¨é‡ {{ weather.rain }}%
                 </span>
              </div>
          </div>
          <div class="pr-2 relative z-10">
             <i :class="weatherIconClass" class="text-[5rem] text-sky-500/90 drop-shadow-sm filter"></i>
          </div>
        </div>

        <transition name="fade">
          <div v-if="shouldShowFlightCard" 
               class="rounded-[28px] p-5 text-white shadow-xl relative overflow-hidden border border-white/20" 
               style="background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);">
              <div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent pointer-events-none"></div>
              
              <button @click.stop="openFlightModal(activeFlight.id)" class="absolute top-4 right-4 z-20 text-white/70 hover:text-white bg-black/20 hover:bg-black/30 p-1.5 rounded-full transition backdrop-blur-sm">
                  <i class="ph ph-pencil-simple text-sm"></i>
              </button>

              <div class="flex justify-between items-center mb-4 relative z-10">
                <div class="text-[10px] font-bold bg-white/20 backdrop-blur-md px-2.5 py-1 rounded-full border border-white/10 tracking-widest">èˆªç­è³‡è¨Š</div>
                <div class="text-right mr-8"> <div class="font-mono font-bold text-xl leading-none">{{ activeFlight.depTime }}</div>
                    <div class="text-[10px] opacity-70 mt-1 font-medium">æŠµé” {{ activeFlight.arrTime }}</div>
                </div>
              </div>
              
              <div class="flex items-center justify-between relative z-10 px-1">
                <div class="text-center">
                   <div class="text-4xl font-black tracking-widest drop-shadow-md">{{ activeFlight.fromCode }}</div>
                  <div class="text-[10px] font-bold opacity-80 mt-1 uppercase tracking-wide">{{ activeFlight.fromTerminal }}</div>
                </div>
                
                <div class="flex-1 px-4 text-center flex flex-col items-center">
                   <i class="ph ph-airplane-tilt text-2xl mb-2 opacity-90"></i>
                  <div class="w-full h-[2px] bg-gradient-to-r from-transparent via-white/50 to-transparent relative">
                      <div class="absolute right-0 top-1/2 -translate-y-1/2 w-1 h-1 bg-white rounded-full"></div>
                      <div class="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-1 bg-white rounded-full"></div>
                  </div>
                  <div class="text-[10px] mt-2 opacity-80 font-medium">{{ activeFlight.note }}</div>
                </div>
                
                <div class="text-center">
                   <div class="text-4xl font-black tracking-widest drop-shadow-md">{{ activeFlight.toCode }}</div>
                  <div class="text-[10px] font-bold opacity-80 mt-1 uppercase tracking-wide">{{ activeFlight.toTerminal }}</div>
                </div>
              </div>

              <div class="mt-5 flex justify-between items-center relative z-10 border-t border-white/20 pt-3">
                <div class="text-xs font-medium opacity-90">{{ activeFlight.code }} <span class="mx-1">Â·</span> {{ activeFlight.title }}</div>
                <div class="bg-white/90 text-sky-600 px-3 py-1 rounded-full text-[10px] font-bold shadow-sm">å·²ç¢ºèª</div>
              </div>
            </div>
        </transition>

        <transition name="fade">
            <div v-if="selectedMapLocation" class="glass-card !bg-white/95 border-2 border-sky-100/50 relative !p-5">
               <button @click="selectedMapLocation = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition">
                    <i class="ph ph-x text-lg"></i>
                </button>
                <div class="mb-5 pr-6">
                    <div class="flex items-center gap-2.5 mb-2">
                         <div class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-500">
                             <i class="ph ph-map-pin-fill text-lg"></i>
                        </div>
                         <h4 class="text-lg font-bold text-gray-800 leading-tight">{{ selectedMapLocation.title }}</h4>
                    </div>
                    <p class="text-sm text-gray-500 pl-[42px] leading-relaxed">{{ selectedMapLocation.address }}</p>
                </div>
                <div class="flex justify-center gap-3">
                    <a :href="generateMapLink(selectedMapLocation.address, 'search')" target="_blank"
                       class="flex-1 py-3 px-2 flex items-center justify-center gap-2 bg-gray-50 border border-gray-200 text-gray-700 rounded-xl font-bold shadow-sm active:scale-95 transition text-sm">
                       <i class="ph ph-map-trifold text-lg text-blue-500"></i> Google Map
                    </a>
                    <a :href="generateMapLink(selectedMapLocation.address, 'navigate')" target="_blank"
                       class="flex-1 py-3 px-2 flex items-center justify-center gap-2 bg-gradient-to-r from-emerald-500 to-teal-500 text-white border border-transparent rounded-xl font-bold shadow-lg shadow-emerald-200 active:scale-95 transition text-sm">
                       <i class="ph ph-navigation-arrow text-lg"></i> é–‹å§‹å°èˆª
                     </a>
                </div>
            </div>
        </transition>
      </div>

      <div v-if="currentTab !== 'æº–å‚™' && currentTab !== 'è¨˜å¸³'" class="mb-4 sticky top-2 z-20 pointer-events-none w-full flex justify-between items-center">
        <div class="pointer-events-auto">
             <button v-if="isFlightDay && currentTab === 'è¡Œç¨‹'" @click="openFlightModal('new')" class="bg-blue-600/90 backdrop-blur-xl text-white pl-4 pr-5 py-2.5 rounded-full shadow-lg shadow-blue-400/30 active:scale-95 transition-all flex items-center gap-2 border border-white/20">
                <i class="ph ph-airplane-tilt text-xl"></i>
                <span class="text-sm font-bold tracking-wide">æ–°å¢èˆªç­</span>
             </button>
        </div>

        <button @click="openAddModal" class="pointer-events-auto bg-gray-900/90 backdrop-blur-xl text-white pl-4 pr-5 py-2.5 rounded-full shadow-lg shadow-gray-400/30 active:scale-95 transition-all flex items-center gap-2 border border-white/20">
           <i class="ph ph-plus-circle-fill text-xl text-sky-400"></i>
           <span class="text-sm font-bold tracking-wide">æ–°å¢é …ç›®</span>
        </button>
      </div>

      <div class="rounded-[32px] p-1 transition-all duration-300" :class="{'!p-0': currentTab === 'è¨˜å¸³'}">
        
          <div v-if="currentTab === 'æº–å‚™'">
            <div class="flex items-center gap-2 mb-3 ml-2">
                <i class="ph ph-checklist text-lg text-gray-400"></i>
                <h3 class="text-sm font-bold text-gray-500 uppercase tracking-widest">æº–å‚™æ¸…å–®</h3>
            </div>
            <ul class="space-y-3">
              <li v-for="(note, i) in preTripNotes" :key="note.id" class="list-glass rounded-2xl p-4 flex justify-between items-center">
                <div class="flex items-center gap-3 flex-1 min-w-0">
                   <div class="relative cursor-pointer" @click="togglePreNoteDone(note.id)">
                      <i class="ph text-2xl transition-colors" :class="note.isDone ? 'ph-check-circle-fill text-emerald-500' : 'ph-circle text-gray-300 hover:text-gray-400'"></i>
                  </div>
                  <span class="font-medium text-[15px] truncate" :class="{'task-done': note.isDone, 'text-gray-800': !note.isDone}">{{ note.name }}</span>
                </div>
                <div class="flex items-center gap-1 pl-2 flex-shrink-0">
                  <button @click.stop="editPreNote(note)" class="text-gray-400 hover:text-sky-600 p-1.5"><i class="ph ph-pencil-simple text-base"></i></button>
                  <button @click.stop="removePreNote(note.id)" class="text-gray-400 hover:text-red-500 p-1.5"><i class="ph ph-trash text-base"></i></button>
                </div>
               </li>
              <li v-if="preTripNotes.length === 0" class="p-8 text-sm text-gray-400 text-center border-2 border-dashed border-gray-200 rounded-3xl">é‚„æ²’æº–å‚™å¥½å—ï¼ŸåŠ å…¥ä¸€äº›é …ç›®å§ï¼</li>
            </ul>
            
            <div class="mt-6 glass-card !bg-white/60">
              <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2 block">å¿«é€Ÿæ–°å¢</label>
               <div class="flex gap-2">
                <input v-model="newPreNote" @keyup.enter="addPreNote" class="flex-1 p-3 rounded-xl border border-gray-200 bg-white/50 text-base focus:outline-none focus:ring-2 focus:ring-sky-500/50 transition" placeholder="ä¾‹å¦‚ï¼šå…Œæ›å°å¹£">
                <button @click="addPreNote" class="px-5 bg-gray-900 text-white rounded-xl font-bold shadow-lg active:scale-95 transition">åŠ å…¥</button>
              </div>
            </div>
          </div>

          <div v-if="currentTab === 'è¡Œç¨‹'">
            <div class="flex items-center gap-2 mb-3 ml-2">
                <i class="ph ph-path text-lg text-gray-400"></i>
                <h3 class="text-sm font-bold text-gray-500 uppercase tracking-widest">ä»Šæ—¥è¡Œç¨‹</h3>
            </div>
            <ul class="space-y-3 relative">
               <div class="absolute left-[2.85rem] top-4 bottom-4 w-1 bg-gray-400/80 rounded-full z-0"></div>

               <li v-for="(it, idx) in sortedItinerary" :key="it.id" 
                  @click="showLocationOnMap(it)"
                  class="list-glass rounded-2xl p-4 flex justify-between items-center relative overflow-hidden cursor-pointer z-10 transition-all hover:shadow-md">
                
                <div class="flex flex-col items-center mr-4 min-w-[3rem] border-r border-gray-100 pr-4">
                    <span class="text-sm font-bold text-gray-800">{{ it.time || '--' }}</span>
                </div>

                <div class="flex-1 min-w-0">
                  <div class="font-bold text-[15px] text-gray-800 truncate">{{ it.title }}</div>
                  <div class="text-xs text-gray-500 mt-0.5 truncate">{{ it.note }}</div>
                   <div v-if="(it.address || '').trim() !== ''" class="text-[10px] text-sky-600 mt-1.5 flex items-center font-medium bg-sky-50/50 w-fit px-1.5 py-0.5 rounded border border-sky-100">
                      <i class="ph ph-map-pin-line mr-1"></i> æŸ¥çœ‹åœ°åœ–
                  </div>
                </div>

                <div class="flex items-center gap-1 pl-2 flex-shrink-0">
                    <button @click.stop="openItineraryModal(it)" class="text-gray-400 hover:text-sky-600 p-1.5"><i class="ph ph-pencil-simple text-base"></i></button>
                    <button @click.stop="removeItineraryItem(it.id)" class="text-gray-400 hover:text-red-500 p-1.5"><i class="ph ph-trash text-base"></i></button>
                </div>
              </li>
            </ul>

             <p v-if="sortedItinerary.length === 0" class="p-8 text-sm text-gray-400 text-center border-2 border-dashed border-gray-200 rounded-3xl mt-4">ä»Šæ—¥æš«ç„¡è¡Œç¨‹ï¼Œéš¨å¿ƒæ¢ç´¢å§ï¼</p>
            
            <div class="mt-6 glass-card !bg-white/60"> 
               <label class="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2 block">å¿«é€Ÿæ–°å¢</label>
               <div class="flex gap-2">
                   <input v-model="quickItinerary.time" type="time" class="flex-[2] w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-center font-medium focus:outline-none focus:ring-2 focus:ring-sky-500/50">
                   <input v-model="quickItinerary.title" @keyup.enter="addQuickItinerary" class="flex-[3] w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-base focus:outline-none focus:ring-2 focus:ring-sky-500/50" placeholder="æ´»å‹•åç¨±...">
                   <button @click="addQuickItinerary" class="px-4 bg-sky-500 text-white rounded-xl font-bold shadow-md active:scale-95 transition flex items-center justify-center"><i class="ph ph-plus text-xl"></i></button>
              </div>
            </div>
          </div>

          <div v-if="currentTab === 'è³¼ç‰©'">
            <div class="flex items-center gap-2 mb-3 ml-2">
                <i class="ph ph-bag text-lg text-gray-400"></i>
                <h3 class="text-sm font-bold text-gray-500 uppercase tracking-widest">è³¼ç‰©æ¸…å–®</h3>
             </div>
            <ul class="space-y-3">
              <li v-for="(item, i) in shoppingList" :key="item.id" class="list-glass rounded-2xl p-3 flex justify-between items-start">
                <div class="flex items-start gap-3 flex-1 min-w-0">
                  <div class="mt-1 cursor-pointer" @click="item.isDone = !item.isDone">
                      <i class="ph text-2xl transition-all" :class="item.isDone ? 'ph-check-circle-fill text-emerald-500' : 'ph-circle text-gray-300 hover:text-gray-400'"></i>
                  </div>
                  <div class="flex-1 min-w-0 pt-0.5">
                    <div class="font-bold text-[15px] truncate" :class="{'task-done': item.isDone, 'text-gray-800': !item.isDone}">{{ item.name }}</div>
                     <div v-if="item.imageURL" class="mt-2.5">
                         <a v-if="isInstagramLink(item.imageURL)" :href="item.imageURL" target="_blank" 
                           class="text-[10px] font-bold text-pink-600 bg-pink-50 border border-pink-100 px-2.5 py-1.5 rounded-lg inline-flex items-center gap-1.5 hover:bg-pink-100 transition">
                           <i class="ph ph-instagram-logo text-sm"></i> æŸ¥çœ‹è²¼æ–‡
                         </a>
                        <div v-else class="relative group/img cursor-pointer w-20 h-20 overflow-hidden rounded-xl border border-gray-200 shadow-sm" @click="openImageViewer(item.imageURL)">
                             <img :src="item.imageURL" class="w-full h-full object-cover transition-transform duration-500 group-hover/img:scale-110" alt="Thumbnail">
                              <div class="absolute inset-0 bg-black/0 group-hover/img:bg-black/10 transition-colors"></div>
                        </div>
                    </div>
                  </div>
                </div>
                <div class="flex items-center gap-1 pl-2 flex-shrink-0">
                    <button @click.stop="openShoppingModal(item)" class="text-gray-400 hover:text-sky-600 p-1.5"><i class="ph ph-pencil-simple text-base"></i></button>
                    <button class="text-red-400 hover:text-red-500 p-1.5" @click="removeShoppingItem(item.id)"><i class="ph ph-trash text-base"></i></button>
                </div>
               </li>
              <li v-if="shoppingList.length === 0" class="p-8 text-sm text-gray-400 text-center border-2 border-dashed border-gray-200 rounded-3xl">æ¸…å–®æ˜¯ç©ºçš„ï¼Œå¿«å»è²·è²·è²·ï¼</li>
            </ul>
          </div>

          <div v-if="currentTab === 'è¨˜å¸³'">
              <div class="expense-card mb-6">
               
                 <div class="absolute top-4 right-4 z-10">
                    <button @click="openExpenseModal(null)" class="bg-white/10 hover:bg-white/20 border border-white/10 text-white p-2 rounded-full backdrop-blur-md transition shadow-inner">
                        <i class="ph ph-plus text-xl font-bold"></i>
                    </button>
                </div>

                <div class="text-center mb-8 mt-2 relative z-10">
                    <div class="text-blue-200 text-[10px] font-bold tracking-[0.2em] uppercase mb-2">ç¸½æ”¯å‡º (HKD)</div>
                    <div class="text-5xl font-light tracking-tight mb-1 text-white drop-shadow-lg flex justify-center items-start">
                       <span class="text-2xl mt-1 opacity-60 mr-1">$</span>{{ formatNumber(totalExpense.hkd, 0) }}
                    </div>
                    <div class="text-white/50 text-sm font-medium tracking-wide">â‰ˆ TWD {{ formatNumber(totalExpense.twd, 0) }}</div>
                </div>
                
                  <div class="grid grid-cols-2 gap-0 border-t border-white/10 pt-4 relative z-10">
                    <div class="text-center border-r border-white/10 pr-2">
                        <div class="text-blue-300/80 text-[9px] uppercase tracking-wider mb-1"><i class="ph ph-credit-card mr-1"></i>ä¿¡ç”¨å¡</div>
                        <div class="text-xl font-bold text-white/90">${{ formatNumber(totalExpense.creditHkd, 0) }}</div>
                    </div>
                    <div class="text-center pl-2">
                        <div class="text-blue-300/80 text-[9px] uppercase tracking-wider mb-1"><i class="ph ph-coins mr-1"></i>ç¾é‡‘</div>
                        <div class="text-xl font-bold text-white/90">${{ formatNumber(totalExpense.cashHkd, 0) }}</div>
                    </div>
                 </div>
             </div>

            <div class="bg-gray-200/40 p-1.5 rounded-2xl flex mb-4 backdrop-blur-sm mx-1">
                <button v-for="f in ['all', 'credit', 'cash']" :key="f"
                @click="expenseFilter = f"
                    class="flex-1 py-2 text-xs font-bold rounded-xl transition-all duration-300"
                    :class="expenseFilter === f ? 'bg-white text-gray-900 shadow-sm' : 'text-gray-500 hover:text-gray-700'">
                    {{ f === 'all' ? 'å…¨éƒ¨' : (f === 'credit' ? 'ä¿¡ç”¨å¡' : 'ç¾é‡‘') }}
                </button>
            </div>

            <div class="rounded-3xl bg-white/40 backdrop-blur-xl border border-white/40 shadow-sm p-2 min-h-[200px]">
                 <ul class="space-y-1">
                <li v-for="(e, i) in filteredExpenses" :key="e.id" class="p-3 rounded-2xl hover:bg-white/50 transition flex justify-between items-center group cursor-default">
                    <div class="flex items-center gap-3.5">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center text-lg" 
                             :class="e.paymentMethod === 'credit_card' ? 'bg-indigo-100 text-indigo-500' : 'bg-emerald-100 text-emerald-500'">
                             <i class="ph" :class="e.paymentMethod === 'credit_card' ? 'ph-credit-card' : 'ph-coins'"></i>
                        </div>
                    <div>
                        <div class="font-bold text-gray-800 text-[15px]">{{ e.name }}</div>
                        <div class="text-[11px] font-medium text-gray-400 mt-0.5">{{ e.category }} Â· {{ e.date }}</div>
                    </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="text-right">
                              <div class="font-bold text-gray-800 text-[15px]">{{ e.currency }} {{ formatNumber(e.amount, 0) }}</div>
                        </div>
                        <div class="flex gap-1">
                           <button @click="openExpenseModal(e)" class="text-gray-400 hover:text-sky-600 p-1"><i class="ph ph-pencil-simple"></i></button>
                           <button @click="removeExpense(e.id)" class="text-red-300 hover:text-red-500 p-1"><i class="ph ph-trash"></i></button>
                        </div>
                    </div>
               </li>
                <li v-if="filteredExpenses.length === 0" class="p-8 text-sm text-gray-400 text-center">
                    æš«ç„¡ç›¸é—œè¨˜éŒ„
                </li>
                </ul>
             </div>
          </div>

          <div v-if="currentTab === 'è³‡è¨Š'">
            <div class="flex items-center gap-2 mb-3 ml-2">
                <i class="ph ph-info text-lg text-gray-400"></i>
                <h3 class="text-sm font-bold text-gray-500 uppercase tracking-widest">å¯¦ç”¨è³‡è¨Š</h3>
            </div>
             <ul class="space-y-3">
              <li v-for="(it, idx) in infoList" :key="it.id" class="list-glass rounded-2xl p-4 flex justify-between items-start">
                <div class="flex items-start gap-3 flex-1 min-w-0">
                  <div class="mt-1 cursor-pointer" @click="it.isDone = !it.isDone">
                    <i class="ph text-2xl" :class="it.isDone ? 'ph-check-circle-fill text-emerald-500' : 'ph-info text-sky-500'"></i>
                  </div>
                  <div class="flex-1 min-w-0">
                    <div class="font-bold text-[15px] text-gray-800 truncate">{{ it.title }}</div>
                    <div class="text-sm text-gray-500 mt-1 whitespace-pre-wrap leading-relaxed">{{ it.note }}</div>
                     <div v-if="it.imageURL" class="mt-3">
                        <div class="relative group/img cursor-pointer w-full h-32 overflow-hidden rounded-xl border border-gray-200 shadow-sm" @click="openImageViewer(it.imageURL)">
                             <img :src="it.imageURL" class="w-full h-full object-cover" alt="Thumbnail">
                         </div>
                    </div>
                   </div>
                </div>
                 <div class="flex items-center gap-1 pl-2 flex-shrink-0">
                     <button @click.stop="openInfoModal(it)" class="text-gray-400 hover:text-sky-600 p-1.5"><i class="ph ph-pencil-simple text-base"></i></button>
                    <button class="text-red-400 hover:text-red-500 p-1.5" @click="removeInfo(it.id)"><i class="ph ph-trash text-base"></i></button>
                 </div>
              </li>
              <li v-if="infoList.length === 0" class="p-8 text-sm text-gray-400 text-center border-2 border-dashed border-gray-200 rounded-3xl">è«‹æ–°å¢é‡è¦çš„è³‡è¨Šå‚™å¿˜</li>
             </ul>
          </div>
      </div>

      <div class="h-28 flex items-end justify-center pb-4">
         <div class="text-[10px] font-mono text-gray-400/50">Designed for Taipei 2025</div>
      </div>
    </main>

    <nav class="fixed bottom-6 left-0 right-0 z-30 px-2 pointer-events-none">
      <div class="iphone-dock w-full max-w-[360px] mx-auto pointer-events-auto transition-transform hover:scale-[1.01] duration-300">
        <button @click="currentTab='è¡Œç¨‹'" class="group flex flex-col items-center justify-center flex-1 transition-all" 
                :class="currentTab==='è¡Œç¨‹' ? 'text-sky-600' : 'text-gray-400 hover:text-gray-600'">
            <i class="ph ph-map-pin text-3xl mb-1 transition-transform group-active:scale-90" :class="currentTab==='è¡Œç¨‹' ? 'fill-current' : ''"></i>
            <span class="text-[10px] font-bold tracking-wide">è¡Œç¨‹</span>
        </button>
        
        <button @click="currentTab='è¨˜å¸³'" class="group flex flex-col items-center justify-center flex-1 transition-all"
                :class="currentTab==='è¨˜å¸³' ? 'text-sky-600' : 'text-gray-400 hover:text-gray-600'">
            <i class="ph ph-wallet text-3xl mb-1 transition-transform group-active:scale-90" :class="currentTab==='è¨˜å¸³' ? 'fill-current' : ''"></i>
            <span class="text-[10px] font-bold tracking-wide">è¨˜å¸³</span>
        </button>
        
        <button @click="currentTab='è³¼ç‰©'" class="group flex flex-col items-center justify-center flex-1 transition-all"
                :class="currentTab==='è³¼ç‰©' ? 'text-sky-600' : 'text-gray-400 hover:text-gray-600'">
            <i class="ph ph-shopping-bag text-3xl mb-1 transition-transform group-active:scale-90" :class="currentTab==='è³¼ç‰©' ? 'fill-current' : ''"></i>
            <span class="text-[10px] font-bold tracking-wide">è³¼ç‰©</span>
        </button>
        
        <button @click="currentTab='è³‡è¨Š'" class="group flex flex-col items-center justify-center flex-1 transition-all"
                :class="currentTab==='è³‡è¨Š' ? 'text-sky-600' : 'text-gray-400 hover:text-gray-600'">
            <i class="ph ph-info text-3xl mb-1 transition-transform group-active:scale-90" :class="currentTab==='è³‡è¨Š' ? 'fill-current' : ''"></i>
            <span class="text-[10px] font-bold tracking-wide">è³‡è¨Š</span>
        </button>
      </div>
    </nav>
    
    <transition name="fade">
        <div v-if="imageViewer.open" class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-xl flex items-center justify-center p-4" @click="imageViewer.open = false">
            <button class="absolute top-6 right-6 text-white/50 hover:text-white p-2 transition">
                <i class="ph ph-x-circle text-4xl"></i>
            </button>
            <img :src="imageViewer.url" class="max-w-full max-h-[85vh] object-contain rounded-2xl shadow-2xl border border-white/10" @click.stop>
        </div>
    </transition>

    <transition name="fade">
      <div v-if="preNoteModalOpen" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-6" @click.self="closePreNoteModal">
        <div class="bg-white/90 backdrop-blur-xl rounded-[28px] w-full max-w-sm p-6 shadow-2xl border border-white/50 transform transition-all scale-100">
          <h3 class="text-xl font-bold mb-5 text-gray-800">{{ editingPreNote.id ? 'ç·¨è¼¯é …ç›®' : 'æ–°å¢é …ç›®' }}</h3>
          <div class="space-y-4">
            <input v-model="editingPreNote.name" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-lg focus:outline-none focus:ring-2 focus:ring-sky-500" placeholder="é …ç›®åç¨±">
            <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
              <input type="checkbox" id="pre-note-done" v-model="editingPreNote.isDone" class="w-5 h-5 text-sky-600 rounded border-gray-300 focus:ring-sky-500">
              <label for="pre-note-done" class="text-gray-700 font-medium select-none">æ¨™è¨˜ç‚ºå·²å®Œæˆ</label>
            </div>
          </div>
          <div class="mt-8 flex gap-3">
            <button @click="closePreNoteModal" class="flex-1 py-3 text-gray-600 font-bold rounded-xl bg-gray-100 hover:bg-gray-200 transition">å–æ¶ˆ</button>
            <button @click="savePreNoteEdit" class="flex-1 py-3 bg-black text-white font-bold rounded-xl shadow-lg hover:bg-gray-800 transition">å„²å­˜</button>
          </div>
        </div>
      </div>
    </transition>

    <transition name="fade">
         <div v-if="flightModalOpen" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-6" @click.self="closeFlightModal">
             <div class="bg-white/90 backdrop-blur-xl rounded-[28px] w-full max-w-sm p-6 shadow-2xl border border-white/50 h-[80vh] overflow-y-auto no-scrollbar">
                <h3 class="text-xl font-bold mb-5 text-gray-800">{{ newFlight.id ? 'ç·¨è¼¯èˆªç­' : 'æ–°å¢èˆªç­' }}</h3>
                <div class="space-y-3">
                    <div class="p-1 bg-gray-100 rounded-xl flex mb-2">
                        <button class="flex-1 py-2 rounded-lg text-xs font-bold transition-all" :class="newFlight.type==='outbound' ? 'bg-white shadow text-black' : 'text-gray-400'" @click="newFlight.type='outbound'">å»ç¨‹</button>
                         <button class="flex-1 py-2 rounded-lg text-xs font-bold transition-all" :class="newFlight.type==='return' ? 'bg-white shadow text-black' : 'text-gray-400'" @click="newFlight.type='return'">å›ç¨‹</button>
                    </div>
                    <input v-model="newFlight.date" type="date" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base">
                    <input v-model="newFlight.code" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base" placeholder="èˆªç­ä»£ç¢¼ (å¦‚: CX400)">
                    <div class="flex gap-3">
                        <input v-model="newFlight.fromCode" class="flex-1 min-w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-base text-center uppercase" placeholder="HKG">
                        <input v-model="newFlight.toCode" class="flex-1 min-w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-base text-center uppercase" placeholder="TPE">
                     </div>
                    <div class="flex gap-3">
                        <input v-model="newFlight.depTime" type="time" class="flex-1 p-3 rounded-xl border border-gray-200 bg-white/50 text-base">
                        <input v-model="newFlight.arrTime" type="time" class="flex-1 p-3 rounded-xl border border-gray-200 bg-white/50 text-base">
                    </div>
                     <textarea v-model="newFlight.note" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base" rows="2" placeholder="å‚™è¨» (èˆªå»ˆã€åº§ä½ç­‰)"></textarea>
                </div>
                <div class="mt-6 flex gap-3">
                     <button @click="closeFlightModal" class="flex-1 py-3 text-gray-600 font-bold rounded-xl bg-gray-100 hover:bg-gray-200 transition">å–æ¶ˆ</button>
                    <button @click="saveFlight" class="flex-1 py-3 bg-sky-500 text-white font-bold rounded-xl shadow-lg hover:bg-sky-600 transition">å„²å­˜</button>
                </div>
            </div>
        </div>
    </transition>

    <transition name="fade">
        <div v-if="itineraryModalOpen" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-6" @click.self="closeItineraryModal">
            <div class="bg-white/90 backdrop-blur-xl rounded-[28px] w-full max-w-sm p-6 shadow-2xl border border-white/50">
                 <h3 class="text-xl font-bold mb-5 text-gray-800">{{ newItineraryItem.id ? 'ç·¨è¼¯è¡Œç¨‹' : 'æ–°å¢è¡Œç¨‹' }}</h3>
                <div class="space-y-4">
                    <div class="flex gap-3 mb-1">
                        <select v-model="newItineraryItem.dayIndex" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-medium text-gray-700 focus:outline-none focus:ring-2 focus:ring-sky-500">
                             <option v-for="(d, i) in days" :key="i" :value="i">
                                 Day {{ i+1 }} - {{ d.date }}
                             </option>
                        </select>
                    </div>
                    <div class="flex gap-2">
                        <input v-model="newItineraryItem.time" type="time" class="flex-[2] w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-base text-center font-bold">
                         <input v-model="newItineraryItem.title" class="flex-[3] w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-medium" placeholder="æ¨™é¡Œ">
                    </div>
                    <div class="relative">
                        <i class="ph ph-map-pin absolute left-3 top-3.5 text-gray-400"></i>
                         <input v-model="newItineraryItem.address" class="w-full pl-10 p-3 rounded-xl border border-gray-200 bg-white/50 text-base" placeholder="Google åœ°åœ–åœ°å€">
                    </div>
                    <textarea v-model="newItineraryItem.note" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base" rows="3" placeholder="å‚™è¨»..."></textarea>
                </div>
                 <div class="mt-6 flex gap-3">
                    <button @click="closeItineraryModal" class="flex-1 py-3 text-gray-600 font-bold rounded-xl bg-gray-100 hover:bg-gray-200 transition">å–æ¶ˆ</button>
                    <button @click="saveItineraryItem" class="flex-1 py-3 bg-sky-500 text-white font-bold rounded-xl shadow-lg hover:bg-sky-600 transition">å„²å­˜</button>
                </div>
             </div>
        </div>
    </transition>

    <transition name="fade">
        <div v-if="shoppingModalOpen" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-6" @click.self="closeShoppingModal">
            <div class="bg-white/90 backdrop-blur-xl rounded-[28px] w-full max-w-sm p-6 shadow-2xl border border-white/50">
                <h3 class="text-xl font-bold mb-5 text-gray-800">{{ newShoppingItem.id ? 'ç·¨è¼¯é …ç›®' : 'æ–°å¢é …ç›®' }}</h3>
                <div class="space-y-4 text-sm">
                    <input v-model="newShoppingItem.name" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-medium" placeholder="æƒ³è²·ä»€éº¼ï¼Ÿ">
                    
                    <div class="border-t border-gray-200 pt-4">
                        <label class="block text-xs font-bold text-gray-400 mb-2 uppercase tracking-wide">åƒè€ƒåœ–ç‰‡</label>
                        <input v-model="newShoppingItem.imageURL" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-xs mb-3 font-mono text-gray-500" placeholder="https://...">
                        
                         <label class="flex items-center justify-center w-full p-4 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:bg-gray-50 hover:border-sky-300 transition group">
                            <div class="text-center" v-if="!tempUploadPreview.shopping && !newShoppingItem.imageURL">
                                <i class="ph ph-image text-2xl text-gray-300 group-hover:text-sky-500 mb-1"></i>
                                 <div class="text-gray-400 text-xs font-medium">ä¸Šå‚³åœ–ç‰‡</div>
                            </div>
                            <div v-else class="text-center text-sky-500 font-bold text-xs">
                                {{ uploadStatus.shopping || 'åœ–ç‰‡å·²é¸å–' }}
                            </div>
                            <input type="file" accept="image/*" class="hidden" @change="(e) => handleFileUpload(e, 'shopping')">
                        </label>
            
                         
                         <div v-if="tempUploadPreview.shopping" class="mt-3 flex justify-center">
                             <img :src="tempUploadPreview.shopping" class="h-20 w-20 object-cover rounded-xl shadow-sm border border-white">
                         </div>
                    </div>

                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl mt-2">
                        <input type="checkbox" id="shopping-done" v-model="newShoppingItem.isDone" class="w-5 h-5 text-sky-600 rounded border-gray-300">
                        <label for="shopping-done" class="text-gray-700 font-medium select-none">å·²è³¼è²·</label>
                    </div>
                </div>
                <div class="mt-6 flex gap-3">
                    <button @click="closeShoppingModal" class="flex-1 py-3 text-gray-600 font-bold rounded-xl bg-gray-100 hover:bg-gray-200 transition">å–æ¶ˆ</button>
                    <button @click="saveShoppingItem" class="flex-1 py-3 bg-black text-white font-bold rounded-xl shadow-lg hover:bg-gray-800 transition disabled:opacity-50" :disabled="isUploading">
                        {{ isUploading ? 'ä¸Šå‚³ä¸­...' : 'å„²å­˜' }}
                    </button>
                </div>
            </div>
        </div>
    </transition>

    <transition name="fade">
        <div v-if="expenseModalOpen" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-6" @click.self="closeExpenseModal">
            <div class="bg-white/90 backdrop-blur-xl rounded-[28px] w-full max-w-sm p-6 shadow-2xl border border-white/50">
                <h3 class="text-xl font-bold mb-5 text-gray-800">{{ newExpense.id ? 'ç·¨è¼¯æ¶ˆè²»' : 'æ–°å¢æ¶ˆè²»' }}</h3>
                <div class="space-y-4">
                    <input v-model="newExpense.name" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-lg font-medium" placeholder="æè¿° (å¦‚: æ™šé¤)">
                    
                    <div class="flex gap-2 w-full">
                         <div class="relative w-24 flex-shrink-0">
                             <select v-model="newExpense.currency" class="w-full appearance-none p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-bold text-center">
                                <option value="TWD">TWD</option>
                                 <option value="HKD">HKD</option>
                                <option value="JPY">JPY</option>
                                <option value="USD">USD</option>
                             </select>
                            <i class="ph ph-caret-down absolute right-3 top-4 text-gray-400 text-xs pointer-events-none"></i>
                        </div>
                        <input v-model.number="newExpense.amount" type="number" class="flex-1 min-w-0 p-3 rounded-xl border border-gray-200 bg-white/50 text-lg font-bold" placeholder="0.00">
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div class="relative">
                            <select v-model="newExpense.category" class="w-full appearance-none p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-medium text-gray-600">
                                <option value="é¤é£²">ğŸ” é¤é£²</option>
                                <option value="äº¤é€š">ğŸš• äº¤é€š</option>
                                <option value="è³¼ç‰©">ğŸ› è³¼ç‰©</option>
                                <option value="å…¶ä»–">ğŸ§© å…¶ä»–</option>
                            </select>
                            <i class="ph ph-caret-down absolute right-3 top-4 text-gray-400 text-xs pointer-events-none"></i>
                        </div>
                        <div class="relative">
                            
                            <select v-model="newExpense.paymentMethod" class="w-full appearance-none p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-medium text-gray-600">
                                <option value="cash">ğŸ’µ ç¾é‡‘</option>
                                <option value="credit_card">ğŸ’³ ä¿¡ç”¨å¡</option>
                             </select>
                             <i class="ph ph-caret-down absolute right-3 top-4 text-gray-400 text-xs pointer-events-none"></i>
                        </div>
                    </div>

                    <div class="mt-2">
                        <label class="block text-xs font-bold text-gray-400 mb-1 ml-1 uppercase">æ—¥æœŸ</label>
                        <input v-model="newExpense.date" type="date" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base text-gray-600">
                    </div>
                </div>
                <div class="mt-8 flex gap-3">
                   <button @click="closeExpenseModal" class="flex-1 py-3 text-gray-600 font-bold rounded-xl bg-gray-100 hover:bg-gray-200 transition">å–æ¶ˆ</button>
                    <button @click="saveExpense" class="flex-1 py-3 bg-blue-600 text-white font-bold rounded-xl shadow-lg shadow-blue-200 hover:bg-blue-700 transition">
                        {{ newExpense.id ? 'å„²å­˜' : 'åŠ å…¥' }}
                    </button>
                </div>
            </div>
        </div>
    </transition>

    <transition name="fade">
        <div v-if="infoModalOpen" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-6" @click.self="closeInfoModal">
            <div class="bg-white/90 backdrop-blur-xl rounded-[28px] w-full max-w-sm p-6 shadow-2xl border border-white/50">
                <h3 class="text-xl font-bold mb-5 text-gray-800">{{ newInfoItem.id ? 'ç·¨è¼¯è³‡è¨Š' : 'æ–°å¢è³‡è¨Š' }}</h3>
                <div class="space-y-4">
                    <input v-model="newInfoItem.title" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base font-medium" placeholder="æ¨™é¡Œ">
                    <textarea v-model="newInfoItem.note" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 text-base" rows="4" placeholder="è©³ç´°å…§å®¹..."></textarea>
                    
                    <div class="border-t border-gray-200 pt-4">
                        <label class="block text-xs font-bold text-gray-400 mb-2 uppercase">é™„ä»¶</label>
                         <label class="flex items-center justify-center w-full p-4 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:bg-gray-50 hover:border-sky-300 transition group">
                             <div class="text-center" v-if="!tempUploadPreview.info && !newInfoItem.imageURL">
                                <i class="ph ph-paperclip text-2xl text-gray-300 group-hover:text-sky-500 mb-1"></i>
                                <div class="text-gray-400 text-xs font-medium">ä¸Šå‚³ / è²¼ä¸Šç¶²å€</div>
                            </div>
                            <div v-else class="text-center text-sky-500 font-bold text-xs">
                                {{ uploadStatus.info || 'æª”æ¡ˆå·²å°±ç·’' }}
                            </div>
                            <input type="file" accept="image/*" class="hidden" @change="(e) => handleFileUpload(e, 'info')">
                        </label>
            
                        <input v-model="newInfoItem.imageURL" class="w-full mt-2 p-2 rounded-lg border-none bg-transparent text-xs text-gray-400 text-center" placeholder="æˆ–åœ¨æ­¤è²¼ä¸Šç¶²å€">

                        <div v-if="tempUploadPreview.info" class="mt-3 flex justify-center">
                             <img :src="tempUploadPreview.info" class="h-20 w-20 object-cover rounded-xl shadow-sm border border-white">
                         </div>
                    </div>
                </div>
                <div class="mt-6 flex gap-3">
                   <button @click="closeInfoModal" class="flex-1 py-3 text-gray-600 font-bold rounded-xl bg-gray-100 hover:bg-gray-200 transition">å–æ¶ˆ</button>
                    <button @click="saveInfoItem" class="flex-1 py-3 bg-sky-500 text-white font-bold rounded-xl shadow-lg hover:bg-sky-600 transition" :disabled="isUploading">
                         {{ isUploading ? '...' : 'å„²å­˜' }}
                    </button>
                </div>
            </div>
        </div>
    </transition>


  </div> 

  <script>
    const { createApp, ref, reactive, computed, onMounted, watch } = Vue;
    // --- Constants & Config ---
    const SUPABASE_URL = 'https://myrhatzdypiwwgmmfbuw.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_bnnah-2fsCaQnKZDoKNJQw_NuYQVvKi';
    const TRIP_ID = 'taipei_trip2025';
    const DEFAULT_RATE = 0.25;
    const CURRENCY_RATES = { 'HKD': 1, 'JPY': 0.052, 'USD': 7.8 };
    // --- Utilities ---
    const generateId = () => Date.now() + Math.floor(Math.random() * 1000);
    // FIX: Use JSON parse/stringify for safer deep cloning to avoid Vue Proxy errors
    const deepClone = (obj) => JSON.parse(JSON.stringify(obj));
    const initializeListWithIds = (list) => list.map(item => ({ ...item, id: item.id || generateId() }));
    function isInstagramLink(url) { return url && /^(https?:\/\/(www\.)?instagram\.com\/(p|reel)\/)/i.test(url); }
    function formatNumber(num, precision = 0) {
       if(num === undefined || num === null || num === '') return '0';
       return Number(num).toLocaleString('en-US', { minimumFractionDigits: precision, maximumFractionDigits: precision });
    }

    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    createApp({
      setup() {
        const appVersion = ref('v251214-3.05'); // Point 1: Update Version
        const currentTab = ref('è¡Œç¨‹');
        const selectedDay = ref(0); 

        // --- Sync Status ---
        const syncState = ref('synced');
        const syncStatusText = computed(() => {
          const map = { 'synced': 'å·²åŒæ­¥', 'saving': 'å„²å­˜ä¸­...', 'loading': 'æ›´æ–°ä¸­...', 'error': 'éŒ¯èª¤' };
          return map[syncState.value] || 'æœªçŸ¥';
        });

        // --- Date/Day Info ---
        const days = reactive([
          { date: '15', week: 'Mon', label: 'æŠµé” (Day 1)', type: 'flight-out' },
          { date: '16', week: 'Tue', label: 'Day 2', type: 'normal' },
          { date: '17', week: 'Wed', label: 'Day 3', type: 'normal' },
          { date: '18', week: 'Thu', label: 'å›ç¨‹ (Day 4)', type: 'flight-return' },
        ]);
        const isFlightDay = computed(() => ['flight-out', 'flight-return'].includes(days[selectedDay.value]?.type));

        // --- Data ---
        const itinerary = reactive([[], [], [], []]);
        // Initialize empty, will fill from cloud/default
        const sortedItinerary = computed(() => {
          const list = itinerary[selectedDay.value] || [];
          return [...list].sort((a, b) => (a.time || '23:59').localeCompare(b.time || '23:59'));
        });
        const selectedMapLocation = ref(null);
        function showLocationOnMap(item) {
          selectedMapLocation.value = (item.address && item.address.trim() !== '') ? { title: item.title, address: item.address, id: item.id } : null;
        }
        
        // Point 3: Fix Map Links
        function generateMapLink(address, type) {
          if (!address) return '#';
          const q = encodeURIComponent(address);
          if (type === 'search') {
              return `https://www.google.com/maps/search/?api=1&query=${q}`;
          } else {
              return `https://www.google.com/maps/dir/?api=1&destination=${q}&travelmode=walking`;
          }
        }

        const flights = ref([
           { id: 'outbound', type: 'outbound', date: '2025-12-15', code: 'CX400', depTime: '12:45', arrTime: '14:45', fromCode: 'HKG', fromTerminal: 'T1', toCode: 'TPE', toTerminal: 'T2', title: 'Cathay Pacific', note: 'ç¶“æ¿Ÿè‰™', isConfirmed: true },
           { id: 'return', type: 'return', date: '2025-12-18', code: 'CX443', depTime: '17:00', arrTime: '18:55', fromCode: 'TPE', fromTerminal: 'T2', toCode: 'HKG', toTerminal: 'T1', title: 'Cathay Pacific', note: 'ç¶“æ¿Ÿè‰™', isConfirmed: false }
        ]);
        const activeFlight = computed(() => {
          const type = days[selectedDay.value]?.type;
          return (type === 'flight-out') ? flights.value.find(f => f.type === 'outbound') : (type === 'flight-return' ? flights.value.find(f => f.type === 'return') : null);
        });
        const shouldShowFlightCard = computed(() => activeFlight.value !== null && currentTab.value === 'è¡Œç¨‹');
        // --- File Upload ---
        const isUploading = ref(false);
        const uploadStatus = reactive({ shopping: '', info: '' });
        const tempUploadPreview = reactive({ shopping: null, info: null });
        const pendingUploadFiles = { shopping: null, info: null };

        function handleFileUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;
            tempUploadPreview[type] = URL.createObjectURL(file);
            pendingUploadFiles[type] = file;
            uploadStatus[type] = 'æº–å‚™ä¸Šå‚³...';
        }

        async function uploadFileToSupabase(file) {
            if (!file) return null;
            const fileName = `${Date.now()}_${Math.floor(Math.random()*1000)}_${file.name.replace(/[^a-zA-Z0-9.]/g, '')}`;
            try {
                const { error } = await supabaseClient.storage.from('uploads').upload(fileName, file);
                if (error) throw error;
                const { data } = supabaseClient.storage.from('uploads').getPublicUrl(fileName);
                return data.publicUrl;
            } catch (e) {
                console.error(e);
                alert('Upload failed');
                return null;
            }
        }

        // --- Image Viewer ---
        const imageViewer = reactive({ open: false, url: '' });
        function openImageViewer(url) {
            if (!url) return;
            if (isInstagramLink(url)) window.open(url, '_blank');
            else { imageViewer.url = url; imageViewer.open = true; }
        }

        // --- Modals State ---
        const itineraryModalOpen = ref(false);
        const newItineraryItem = reactive({});
        const quickItinerary = reactive({ title: '', time: '' });
        const shoppingList = ref([]);
        const shoppingModalOpen = ref(false);
        const newShoppingItem = reactive({});
        const expenses = ref([]);
        const expenseModalOpen = ref(false);
        const expenseFilter = ref('all');
        const newExpense = reactive({});
        const infoList = ref([]);
        const infoModalOpen = ref(false);
        const newInfoItem = reactive({});
        const preTripNotes = ref([]);
        const newPreNote = ref('');
        const preNoteModalOpen = ref(false);
        const editingPreNote = reactive({});
        const flightModalOpen = ref(false);
        const newFlight = reactive({});
        // --- Logic ---
        const totalExpense = computed(() => {
          const rateVal = Number(rate.value) || DEFAULT_RATE;
          let total = 0, credit = 0, cash = 0;
          expenses.value.forEach(e => {
             let amount = Number(e.amount) || 0;
             if (e.currency === 'TWD') amount *= rateVal;
             else if (CURRENCY_RATES[e.currency]) amount *= CURRENCY_RATES[e.currency];
             
             total += amount;
             if(e.paymentMethod === 'credit_card') credit += amount; else cash += amount;
          });
          return { hkd: total, twd: total / rateVal, creditHkd: credit, creditTwd: credit / rateVal, cashHkd: cash, cashTwd: cash / rateVal };
        });
        const filteredExpenses = computed(() => {
            let list = expenses.value;
            if (expenseFilter.value === 'credit') list = list.filter(e => e.paymentMethod === 'credit_card');
            else if (expenseFilter.value === 'cash') list = list.filter(e => e.paymentMethod !== 'credit_card');
            return [...list].sort((a, b) => b.id - a.id);
        });
        // --- Weather & Rate ---
        const weather = reactive({ temp:'--', desc:'è¼‰å…¥ä¸­', rain:0, code:0 });
        const weatherIconClass = computed(() => {
            const c = weather.code;
            if (c >= 95) return 'ph ph-cloud-lightning-rain';
            if (c >= 80) return 'ph ph-cloud-rain';
            if (c > 2) return 'ph ph-cloud';
            return 'ph ph-sun';
        });
        const rate = ref(null);
        const formattedRate = computed(() => rate.value || '...');

        function selectDay(i){ selectedDay.value = i; selectedMapLocation.value = null; }

        // --- Actions ---
        function openItineraryModal(item = null) {
            Object.assign(newItineraryItem, item ? deepClone(item) : { id: null, title: '', note: '', time: '', address: '', dayIndex: selectedDay.value });
            if(item) newItineraryItem.originalDayIndex = selectedDay.value;
            itineraryModalOpen.value = true;
        }
        function closeItineraryModal() { itineraryModalOpen.value = false; }
        function saveItineraryItem() {
            if (!newItineraryItem.title.trim()) return;
            const item = { ...newItineraryItem, id: newItineraryItem.id || generateId() };
            const target = itinerary[item.dayIndex];
            if (item.id && item.originalDayIndex !== undefined && item.originalDayIndex !== item.dayIndex) {
                const oldList = itinerary[item.originalDayIndex];
                const idx = oldList.findIndex(i => i.id === item.id);
                if (idx !== -1) oldList.splice(idx, 1);
                target.push(item);
            } else if (item.id) {
                const idx = target.findIndex(i => i.id === item.id);
                if(idx !== -1) target.splice(idx, 1, item); else target.push(item);
            } else {
                target.push(item);
            }
            if (selectedMapLocation.value?.id === item.id) showLocationOnMap(item);
            closeItineraryModal(); saveAll();
        }
        function removeItineraryItem(id) {
            if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) {
                const idx = itinerary[selectedDay.value].findIndex(i => i.id === id);
                if(idx !== -1) itinerary[selectedDay.value].splice(idx, 1);
                saveAll();
            }
        }
        function addQuickItinerary(){
            if(!quickItinerary.title) return;
            itinerary[selectedDay.value].push({ id: generateId(), title: quickItinerary.title, time: quickItinerary.time || '', note: '', address: '' });
            quickItinerary.title = ''; quickItinerary.time = '';
            saveAll();
        }

        // Generic Save Helpers
        function openGenericModal(modalRef, dataRef, defaultData, item) {
             // reset
             if(modalRef === shoppingModalOpen || modalRef === infoModalOpen) {
                 tempUploadPreview.shopping = null;
                 tempUploadPreview.info = null;
                 pendingUploadFiles.shopping = null; pendingUploadFiles.info = null;
                 uploadStatus.shopping = ''; uploadStatus.info = '';
             }
             Object.assign(dataRef, item ? deepClone(item) : defaultData);
             modalRef.value = true;
        }

        function openShoppingModal(item) { openGenericModal(shoppingModalOpen, newShoppingItem, { id: null, name: '', imageURL: '', isDone: false }, item); }
        function closeShoppingModal() { shoppingModalOpen.value = false; }
        async function saveShoppingItem() {
            if(!newShoppingItem.name) return;
            if(pendingUploadFiles.shopping) {
                isUploading.value = true;
                uploadStatus.shopping = 'ä¸Šå‚³ä¸­...';
                const url = await uploadFileToSupabase(pendingUploadFiles.shopping);
                if(url) newShoppingItem.imageURL = url;
                isUploading.value = false;
            }
            saveToList(shoppingList, newShoppingItem); closeShoppingModal();
        }
        function removeShoppingItem(id) { removeFromList(shoppingList, id); }

        function openInfoModal(item) { openGenericModal(infoModalOpen, newInfoItem, { id: null, title: '', note: '', isDone: false, imageURL: '' }, item); }
        function closeInfoModal() { infoModalOpen.value = false; }
        async function saveInfoItem() {
             if(!newInfoItem.title) return;
             if(pendingUploadFiles.info) {
                isUploading.value = true;
                uploadStatus.info = 'ä¸Šå‚³ä¸­...';
                const url = await uploadFileToSupabase(pendingUploadFiles.info);
                if(url) newInfoItem.imageURL = url;
                isUploading.value = false;
            }
             saveToList(infoList, newInfoItem); closeInfoModal();
        }
        function removeInfo(id) { removeFromList(infoList, id); }

        function addPreNote() { if(newPreNote.value.trim()) { preTripNotes.value.push({id: generateId(), name: newPreNote.value, isDone: false}); newPreNote.value=''; saveAll(); } }
        function removePreNote(id) { removeFromList(preTripNotes, id); }
        function togglePreNoteDone(id) { const n = preTripNotes.value.find(x=>x.id===id); if(n) {n.isDone=!n.isDone; saveAll();} }
        function editPreNote(n) { openGenericModal(preNoteModalOpen, editingPreNote, {}, n); }
        function closePreNoteModal() { preNoteModalOpen.value = false; }
        function savePreNoteEdit() { saveToList(preTripNotes, editingPreNote); closePreNoteModal(); }

        function openExpenseModal(item) {
            const def = { id: null, name:'', amount:null, currency:'TWD', category:'é¤é£²', paymentMethod:'cash', date: new Date().toISOString().split('T')[0] };
            openGenericModal(expenseModalOpen, newExpense, def, item);
        }
        function closeExpenseModal() { expenseModalOpen.value = false; }
        function saveExpense() {
            if(!newExpense.name || !newExpense.amount) return;
            // Ensure ID exists
            const item = { ...newExpense, id: newExpense.id || generateId() };
            // Simple array handling directly
            if (newExpense.id) {
                const idx = expenses.value.findIndex(e => e.id === newExpense.id);
                if(idx !== -1) expenses.value.splice(idx, 1, item);
            } else {
                expenses.value.unshift(item);
            }
            closeExpenseModal(); saveAll();
        }
        function removeExpense(id) { removeFromList(expenses, id); }

        function openFlightModal(id) {
             const def = { id: null, type: 'outbound', date: '2025-12-15', code: '', depTime:'', arrTime:'', fromCode:'HKG', toCode:'TPE' };
             if(id === 'new') {
                 def.type = days[selectedDay.value]?.type === 'flight-return' ? 'return' : 'outbound';
                 if(def.type === 'return') { def.fromCode='TPE'; def.toCode='HKG'; def.date='2025-12-18'; }
                 Object.assign(newFlight, def);
             } else {
                 const f = flights.value.find(x => x.id === id) || flights.value.find(x => x.type === id); // id can be 'outbound' string
                 Object.assign(newFlight, f ? deepClone(f) : def);
             }
             flightModalOpen.value = true;
        }
        function closeFlightModal() { flightModalOpen.value = false; }
        function saveFlight() {
            const item = { ...newFlight, id: newFlight.id || newFlight.type };
            const idx = flights.value.findIndex(f => f.id === item.id);
            if(idx !== -1) flights.value.splice(idx, 1, item); else flights.value.push(item);
            closeFlightModal(); saveAll();
        }

        // Point 9: Always open Itinerary Item modal for '+' button on Itinerary tab
        function openAddModal() {
            const t = currentTab.value;
            // Removed previous "isFlightDay" check here, logic split to the left button
            if(t === 'è¡Œç¨‹') openItineraryModal();
            else if(t === 'è³¼ç‰©') openShoppingModal();
            else if(t === 'è³‡è¨Š') openInfoModal();
            else if(t === 'æº–å‚™') addPreNote();
            else if(t === 'è¨˜å¸³') openExpenseModal();
        }

        // Shared List Helpers
        function saveToList(listRef, item) {
            const saveItem = { ...item, id: item.id || generateId() };
            const idx = listRef.value.findIndex(x => x.id === saveItem.id);
            if(idx !== -1) listRef.value.splice(idx, 1, saveItem); else listRef.value.push(saveItem);
            saveAll();
        }
        function removeFromList(listRef, id) {
            if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) {
                listRef.value = listRef.value.filter(x => x.id !== id);
                saveAll();
            }
        }

        // --- Sync ---
        let isRemoteUpdate = false;
        let debounce = null;
        function getPayload() {
            return {
                itinerary: JSON.parse(JSON.stringify(itinerary)),
                preTripNotes: preTripNotes.value,
                shoppingList: shoppingList.value,
                expenses: expenses.value,
                infoList: infoList.value,
                flights: flights.value
            };
        }
        function applyData(d) {
            if(!d) return;
            isRemoteUpdate = true;
            if(d.itinerary) d.itinerary.forEach((day, i) => itinerary[i] = initializeListWithIds(day));
            if(d.preTripNotes) preTripNotes.value = initializeListWithIds(d.preTripNotes);
            if(d.shoppingList) shoppingList.value = initializeListWithIds(d.shoppingList);
            if(d.expenses) expenses.value = initializeListWithIds(d.expenses);
            if(d.infoList) infoList.value = initializeListWithIds(d.infoList);
            if(d.flights) flights.value = initializeListWithIds(d.flights);
            setTimeout(() => isRemoteUpdate = false, 500);
        }
        async function saveAll() {
            if(isRemoteUpdate) return;
            syncState.value = 'saving';
            if(debounce) clearTimeout(debounce);
            debounce = setTimeout(async () => {
                try {
                    const { error } = await supabaseClient.from('trip_data').upsert({ id: TRIP_ID, content: getPayload() });
                    if(error) throw error;
                    
                    syncState.value = 'synced';
                } catch(e) { console.error(e); syncState.value = 'error'; }
            }, 1500);
        }
        async function fetchCloud(auto = true) {
            if(syncState.value === 'saving' && auto) return;
            if(!auto) syncState.value = 'loading';
            try {
                const { data } = await supabaseClient.from('trip_data').select('content').eq('id', TRIP_ID).single();
                if(data?.content && JSON.stringify(data.content) !== JSON.stringify(getPayload())) {
                    applyData(data.content);
                }
                syncState.value = 'synced';
            } catch(e) { if(!auto) syncState.value = 'error'; }
        }
        async function forceReloadCloud() { await fetchCloud(false); }

        async function fetchRate() {
            try {
                const res = await fetch('https://open.er-api.com/v6/latest/TWD');
                const d = await res.json();
                if(d?.rates?.HKD) rate.value = d.rates.HKD.toFixed(3);
            } catch(e) {}
        }
        async function fetchWeather() {
             try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=25.0330&longitude=121.5654&current_weather=true&hourly=precipitation_probability&timezone=Asia%2FTaipei');
                const d = await res.json();
                if(d.current_weather) {
                    weather.temp = Math.round(d.current_weather.temperature);
                    weather.code = d.current_weather.weathercode;
                    
                    // TC Descriptions
                    const c = weather.code;
                    if(c >= 95) weather.desc = 'é›·é™£é›¨';
                    else if(c >= 80) weather.desc = 'é™£é›¨';
                    else if(c >= 60) weather.desc = 'å°é›¨';
                    else if(c >= 50) weather.desc = 'æ¯›æ¯›é›¨';
                    else if(c >= 45) weather.desc = 'æœ‰éœ§';
                    else if(c >= 30) weather.desc = 'å¤šé›²';
                    else if(c >= 20) weather.desc = 'å±€éƒ¨å¤šé›²';
                    else if(c >= 10) weather.desc = 'æ™´æ™‚å¤šé›²';
                    else weather.desc = 'æ™´å¤©';
                    
                    const h = new Date().getHours();
                    weather.rain = d.hourly?.precipitation_probability[h] || 0;
                }
             } catch(e) {}
        }

        onMounted(() => {
            fetchCloud(false); fetchRate(); fetchWeather();
            setInterval(fetchRate, 600000); setInterval(fetchWeather, 600000);
            setInterval(() => fetchCloud(true), 15000);
            
            // Initial dummy data if empty (Local dev only)
            if(itinerary[0].length === 0) {
                 itinerary[0] = [
                    { id:1, title: 'èˆªç­æŠµé”', time:'14:45', note:'ç¬¬äºŒèˆªå»ˆ', address:'' },
                    { id:2, title: 'ç™»è¨˜å…¥ä½', time:'16:30', note:'è¥¿é–€ç”º', address:'Westgate Hotel' }
                 ];
            }
        });
        watch([itinerary, preTripNotes, shoppingList, expenses, infoList, flights], () => saveAll(), { deep: true });
        return {
           appVersion, syncState, syncStatusText, forceReloadCloud,
           currentTab, days, selectDay, selectedDay, isFlightDay,
           weather, weatherIconClass, formattedRate,
           activeFlight, shouldShowFlightCard,
           selectedMapLocation, showLocationOnMap, generateMapLink,
           preTripNotes, newPreNote, addPreNote, removePreNote, editPreNote, togglePreNoteDone, preNoteModalOpen, editingPreNote, closePreNoteModal, savePreNoteEdit,
           sortedItinerary, openItineraryModal, closeItineraryModal, saveItineraryItem, removeItineraryItem, itineraryModalOpen, newItineraryItem, quickItinerary, addQuickItinerary,
           shoppingList, openShoppingModal, closeShoppingModal, saveShoppingItem, removeShoppingItem, shoppingModalOpen, newShoppingItem, isInstagramLink,
           expenses, totalExpense, filteredExpenses, expenseFilter, openExpenseModal, closeExpenseModal, saveExpense, removeExpense, expenseModalOpen, newExpense,
           infoList, openInfoModal, closeInfoModal, saveInfoItem, removeInfo, infoModalOpen, newInfoItem,
           openAddModal, flightModalOpen, newFlight, openFlightModal, closeFlightModal, saveFlight,
           handleFileUpload, uploadStatus, tempUploadPreview, isUploading,
           imageViewer, openImageViewer, formatNumber
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
